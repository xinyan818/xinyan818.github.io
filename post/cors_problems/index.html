<!doctype html><html lang=zh dir=ltr><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>跨域问题记录 | 胡思乱</title>
<meta name=keywords content="cors,nginx"><meta name=description content="记录跨域问题的原因，并展示如何使用 Nginx 的配置来解决这些问题
什么是跨源资源共享（CORS）？
跨源资源共享（CORS）是一种浏览器安全策略，用于限制来自不同域的 Web 应用程序对当前域中资源的访问。想要深入了解 CORS，请查阅MDN Web 文档。"><meta name=author content><link rel=canonical href=https://xinyan818.github.io/post/cors_problems/><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=https://xinyan818.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://xinyan818.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://xinyan818.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://xinyan818.github.io/apple-touch-icon.png><link rel=mask-icon href=https://xinyan818.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://xinyan818.github.io/post/cors_problems/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><style>@media screen and (min-width:769px){.post-content input[type=checkbox]:checked~label>img{transform:scale(1.6);cursor:zoom-out;position:relative;z-index:999}.post-content img.zoomCheck{transition:transform .15s ease;z-index:999;cursor:zoom-in}}</style><meta property="og:title" content="跨域问题记录"><meta property="og:description" content="记录跨域问题的原因，并展示如何使用 Nginx 的配置来解决这些问题
什么是跨源资源共享（CORS）？
跨源资源共享（CORS）是一种浏览器安全策略，用于限制来自不同域的 Web 应用程序对当前域中资源的访问。想要深入了解 CORS，请查阅MDN Web 文档。"><meta property="og:type" content="article"><meta property="og:url" content="https://xinyan818.github.io/post/cors_problems/"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-07-18T21:01:00+08:00"><meta property="article:modified_time" content="2023-07-18T21:01:00+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="跨域问题记录"><meta name=twitter:description content="记录跨域问题的原因，并展示如何使用 Nginx 的配置来解决这些问题
什么是跨源资源共享（CORS）？
跨源资源共享（CORS）是一种浏览器安全策略，用于限制来自不同域的 Web 应用程序对当前域中资源的访问。想要深入了解 CORS，请查阅MDN Web 文档。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://xinyan818.github.io/post/"},{"@type":"ListItem","position":2,"name":"跨域问题记录","item":"https://xinyan818.github.io/post/cors_problems/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"跨域问题记录","name":"跨域问题记录","description":"记录跨域问题的原因，并展示如何使用 Nginx 的配置来解决这些问题\n什么是跨源资源共享（CORS）？ 跨源资源共享（CORS）是一种浏览器安全策略，用于限制来自不同域的 Web 应用程序对当前域中资源的访问。想要深入了解 CORS，请查阅MDN Web 文档。\n","keywords":["cors","nginx"],"articleBody":"记录跨域问题的原因，并展示如何使用 Nginx 的配置来解决这些问题\n什么是跨源资源共享（CORS）？ 跨源资源共享（CORS）是一种浏览器安全策略，用于限制来自不同域的 Web 应用程序对当前域中资源的访问。想要深入了解 CORS，请查阅MDN Web 文档。\n跨域问题与 Nginx 配置 当前端直接请求服务端接口时，经常会遇到跨域问题，你可能会在浏览器的控制台看到如下错误：\nAccess to XMLHttpRequest at ‘https://test.xxx.com’ from origin ‘http://localhost:8080’ has been blocked by CORS policy: Response to preflight request doesn’t pass access control check: No ‘Access-Control-Allow-Origin’ header is present on the requested resource.\n在使用 Nginx 作为反向代理时，我们一般可以通过以下配置解决大多数跨域问题：\nlocation / { ... add_header Access-Control-Allow-Origin \"https://localhost:8080\"; add_header Access-Control-Allow-Credentials true; add_header Access-Control-Expose-Headers FooBar; ... } 然而，有一些特殊情况需要额外注意，我们将逐一列举并给出相应的优化配置。\n其他情况 情况一，Nginx反向代理服务端，服务端也进行了跨域设置 此时可能会出现以下错误:\nAccess to XMLHttpRequest at ‘https://test.xxx.com/api/xxx' from origin ‘http://localhost:8080’ has been blocked by CORS policy: Response to preflight request doesn’t pass access control check: The ‘Access-Control-Allow-Origin’ header contains multiple values ‘http://localhost:8080, *’, but only one is allowed.\n可以考虑移除服务端的跨域设置\n或在Nginx中对Access-Control-Allow-Origin进行修改而不是添加，即：\n使用proxy_set_header而不是add_header\nlocation / { ... proxy_set_header Access-Control-Allow-Origin *; ... } 情况二，服务端（或框架）对于预检请求没有特殊处理 预检请求（Preflight Request）是 CORS 中的一种特殊请求，关于预检请求的详细信息请参考这里。\n在这种情况下，客户端对服务端发起 OPTIONS 请求时可能出现 404 错误，或者收到其他正常响应但没有任何 CORS 相关的头信息字段。这时，浏览器会认定服务器不同意预检请求，从而导致跨域问题。\n解决方案是在 Nginx 中添加如下配置：\nlocation / { ... if ($request_method = 'OPTIONS') { return 204; } ... } 情况三，需要使用Cookie，但配置了Access-Control-Allow-Origin: * 一般这种情况需要使用 cookie，所以配置了Access-Control-Allow-Credentials: true，或客户端使用了withCredentials = true\nAccess-Control-Allow-Credentials：该字段是一个布尔值，表示是否允许发送Cookie。默认情况下，Cookie不包括在CORS请求之中。设为true，即表示服务器明确许可，Cookie可以包含在请求中，一起发给服务器。这个值也只能设为true，如果服务器不要浏览器发送Cookie，删除该字段即可。\n会出现如下报错:\nAccess to XMLHttpRequest at ‘https://test.xxx.com/api/xxx' from origin ‘http://localhost:8080’ has been blocked by CORS policy: Response to preflight request doesn’t pass access control check: The value of the ‘Access-Control-Allow-Origin’ header in the response must not be the wildcard ‘*’ when the request’s credentials mode is ‘include’. The credentials mode of requests initiated by the XMLHttpRequest is controlled by the withCredentials attribute.\n为了解决这个问题，我们不能使用 *，而必须指定具体的 Origin。\n如果你有确定的域名，可以直接将其写入配置中：\nlocation / { ... add_header Access-Control-Allow-Origin http://xxx.com; ... } 如果你需要根据相关规则动态设置 Origin：\nlocation / { ... if ($http_origin ~* \"xxx.com\") { add_header Access-Control-Allow-Origin $http_origin; } ... } 情况四，配置顺序不对 在代理的资源后面加跨域参数无效\nlocation / { proxy_pass http://test.xxx.com/api # ❌写在这里不会生效 ... add_header Access-Control-Allow-Origin $http_origin; ... proxy_pass http://test.xxx.com/api # ✅要写在参数配置下方 } 参考链接 跨域资源共享 CORS 详解 https://www.ruanyifeng.com/blog/2016/04/cors.html\nNginx 轻松搞定跨域问题！https://www.cnblogs.com/konglxblog/p/16114550.html\n","wordCount":"1245","inLanguage":"zh","datePublished":"2023-07-18T21:01:00+08:00","dateModified":"2023-07-18T21:01:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://xinyan818.github.io/post/cors_problems/"},"publisher":{"@type":"Organization","name":"胡思乱","logo":{"@type":"ImageObject","url":"https://xinyan818.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://xinyan818.github.io/ accesskey=h title="胡思乱 (Alt + H)">胡思乱</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://xinyan818.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://xinyan818.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://xinyan818.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://xinyan818.github.io/>主页</a>&nbsp;»&nbsp;<a href=https://xinyan818.github.io/post/>Posts</a></div><h1 class="post-title entry-hint-parent">跨域问题记录</h1><div class=post-meta><span title='2023-07-18 21:01:00 +0800 CST'>2023-07-18</span>&nbsp;·&nbsp;3 分钟</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e8%b7%a8%e5%9f%9f%e9%97%ae%e9%a2%98%e4%b8%8e-nginx-%e9%85%8d%e7%bd%ae aria-label="跨域问题与 Nginx 配置">跨域问题与 Nginx 配置</a></li><li><a href=#%e5%85%b6%e4%bb%96%e6%83%85%e5%86%b5 aria-label=其他情况>其他情况</a><ul><li><a href=#%e6%83%85%e5%86%b5%e4%b8%80nginx%e5%8f%8d%e5%90%91%e4%bb%a3%e7%90%86%e6%9c%8d%e5%8a%a1%e7%ab%af%e6%9c%8d%e5%8a%a1%e7%ab%af%e4%b9%9f%e8%bf%9b%e8%a1%8c%e4%ba%86%e8%b7%a8%e5%9f%9f%e8%ae%be%e7%bd%ae aria-label=情况一，Nginx反向代理服务端，服务端也进行了跨域设置>情况一，Nginx反向代理服务端，服务端也进行了跨域设置</a></li><li><a href=#%e6%83%85%e5%86%b5%e4%ba%8c%e6%9c%8d%e5%8a%a1%e7%ab%af%e6%88%96%e6%a1%86%e6%9e%b6%e5%af%b9%e4%ba%8e%e9%a2%84%e6%a3%80%e8%af%b7%e6%b1%82%e6%b2%a1%e6%9c%89%e7%89%b9%e6%ae%8a%e5%a4%84%e7%90%86 aria-label=情况二，服务端（或框架）对于预检请求没有特殊处理>情况二，服务端（或框架）对于预检请求没有特殊处理</a></li><li><a href=#%e6%83%85%e5%86%b5%e4%b8%89%e9%9c%80%e8%a6%81%e4%bd%bf%e7%94%a8cookie%e4%bd%86%e9%85%8d%e7%bd%ae%e4%ba%86access-control-allow-origin- aria-label="情况三，需要使用Cookie，但配置了Access-Control-Allow-Origin: *">情况三，需要使用Cookie，但配置了Access-Control-Allow-Origin: *</a></li><li><a href=#%e6%83%85%e5%86%b5%e5%9b%9b%e9%85%8d%e7%bd%ae%e9%a1%ba%e5%ba%8f%e4%b8%8d%e5%af%b9 aria-label=情况四，配置顺序不对>情况四，配置顺序不对</a></li></ul></li><li><a href=#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5 aria-label=参考链接>参考链接</a></li></ul></div></details></div><div class=post-content><p>记录跨域问题的原因，并展示如何使用 Nginx 的配置来解决这些问题</p><p>什么是跨源资源共享（CORS）？
跨源资源共享（CORS）是一种浏览器安全策略，用于限制来自不同域的 Web 应用程序对当前域中资源的访问。想要深入了解 CORS，请查阅<a href=https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS>MDN Web 文档</a>。</p><h2 id=跨域问题与-nginx-配置>跨域问题与 Nginx 配置<a hidden class=anchor aria-hidden=true href=#跨域问题与-nginx-配置>#</a></h2><p>当前端直接请求服务端接口时，经常会遇到跨域问题，你可能会在浏览器的控制台看到如下错误：</p><p>Access to XMLHttpRequest at &lsquo;<a href=https://test.xxx.com>https://test.xxx.com</a>&rsquo; from origin &lsquo;http://localhost:8080&rsquo; has been blocked by CORS policy: Response to preflight request doesn&rsquo;t pass access control check: No &lsquo;Access-Control-Allow-Origin&rsquo; header is present on the requested resource.</p><p>在使用 Nginx 作为反向代理时，我们一般可以通过以下配置解决大多数跨域问题：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>...</span>
</span></span><span class=line><span class=cl>    <span class=s>add_header</span> <span class=s>Access-Control-Allow-Origin</span> <span class=s>&#34;https://localhost:8080&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>add_header</span> <span class=s>Access-Control-Allow-Credentials</span> <span class=s>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>add_header</span> <span class=s>Access-Control-Expose-Headers</span> <span class=s>FooBar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>...</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></div><p>然而，有一些特殊情况需要额外注意，我们将逐一列举并给出相应的优化配置。</p><h2 id=其他情况>其他情况<a hidden class=anchor aria-hidden=true href=#其他情况>#</a></h2><h3 id=情况一nginx反向代理服务端服务端也进行了跨域设置>情况一，Nginx反向代理服务端，服务端也进行了跨域设置<a hidden class=anchor aria-hidden=true href=#情况一nginx反向代理服务端服务端也进行了跨域设置>#</a></h3><p>此时可能会出现以下错误:</p><p>Access to XMLHttpRequest at &lsquo;<a href="https://test.xxx.com/api/xxx'">https://test.xxx.com/api/xxx'</a> from origin &lsquo;http://localhost:8080&rsquo; has been blocked by CORS policy: Response to preflight request doesn&rsquo;t pass access control check: The &lsquo;Access-Control-Allow-Origin&rsquo; header contains multiple values &lsquo;http://localhost:8080, *&rsquo;, but only one is allowed.</p><p>可以考虑移除服务端的跨域设置</p><p>或在Nginx中对<code>Access-Control-Allow-Origin</code>进行修改而不是添加，即：</p><p>使用<code>proxy_set_header</code>而不是<code>add_header</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>...</span>
</span></span><span class=line><span class=cl>    <span class=s>proxy_set_header</span> <span class=s>Access-Control-Allow-Origin</span> <span class=s>*</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>...</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></div><h3 id=情况二服务端或框架对于预检请求没有特殊处理>情况二，服务端（或框架）对于预检请求没有特殊处理<a hidden class=anchor aria-hidden=true href=#情况二服务端或框架对于预检请求没有特殊处理>#</a></h3><p>预检请求（Preflight Request）是 CORS 中的一种特殊请求，关于预检请求的详细信息请参考<a href=https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS#%E9%A2%84%E6%A3%80%E8%AF%B7%E6%B1%82>这里</a>。</p><p>在这种情况下，客户端对服务端发起 OPTIONS 请求时可能出现 404 错误，或者收到其他正常响应但没有任何 CORS 相关的头信息字段。这时，浏览器会认定服务器不同意预检请求，从而导致跨域问题。</p><p>解决方案是在 Nginx 中添加如下配置：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>...</span>
</span></span><span class=line><span class=cl>    <span class=s>if</span> <span class=s>(</span><span class=nv>$request_method</span> <span class=p>=</span> <span class=s>&#39;OPTIONS&#39;)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>return</span> <span class=mi>204</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kn>...</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></div><h3 id=情况三需要使用cookie但配置了access-control-allow-origin->情况三，需要使用Cookie，但配置了Access-Control-Allow-Origin: *<a hidden class=anchor aria-hidden=true href=#情况三需要使用cookie但配置了access-control-allow-origin->#</a></h3><p>一般这种情况需要使用 cookie，所以配置了<code>Access-Control-Allow-Credentials: true</code>，或客户端使用了<code>withCredentials = true</code></p><p><em>Access-Control-Allow-Credentials：该字段是一个布尔值，表示是否允许发送Cookie。默认情况下，Cookie不包括在CORS请求之中。设为<code>true</code>，即表示服务器明确许可，Cookie可以包含在请求中，一起发给服务器。这个值也只能设为<code>true</code>，如果服务器不要浏览器发送Cookie，删除该字段即可。</em></p><p>会出现如下报错:</p><p>Access to XMLHttpRequest at &lsquo;<a href="https://test.xxx.com/api/xxx'">https://test.xxx.com/api/xxx'</a> from origin &lsquo;http://localhost:8080&rsquo; has been blocked by CORS policy: Response to preflight request doesn&rsquo;t pass access control check: The value of the &lsquo;Access-Control-Allow-Origin&rsquo; header in the response must not be the wildcard &lsquo;*&rsquo; when the request&rsquo;s credentials mode is &lsquo;include&rsquo;. The credentials mode of requests initiated by the XMLHttpRequest is controlled by the withCredentials attribute.</p><p>为了解决这个问题，我们不能使用 *，而必须指定具体的 Origin。</p><ul><li><p>如果你有确定的域名，可以直接将其写入配置中：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>...</span>
</span></span><span class=line><span class=cl>    <span class=s>add_header</span> <span class=s>Access-Control-Allow-Origin</span> <span class=s>http://xxx.com</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>...</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></div></li><li><p>如果你需要根据相关规则动态设置 Origin：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>...</span>
</span></span><span class=line><span class=cl>    <span class=s>if</span> <span class=s>(</span><span class=nv>$http_origin</span> <span class=p>~</span><span class=sr>*</span> <span class=s>&#34;xxx.com&#34;)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>add_header</span> <span class=s>Access-Control-Allow-Origin</span> <span class=nv>$http_origin</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kn>...</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></div></li></ul><h3 id=情况四配置顺序不对>情况四，配置顺序不对<a hidden class=anchor aria-hidden=true href=#情况四配置顺序不对>#</a></h3><p>在代理的资源后面加跨域参数<strong>无效</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_pass</span> <span class=s>http://test.xxx.com/api</span>  <span class=c1># ❌写在这里不会生效
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=s>...</span>
</span></span><span class=line><span class=cl>    <span class=s>add_header</span> <span class=s>Access-Control-Allow-Origin</span> <span class=nv>$http_origin</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>proxy_pass</span> <span class=s>http://test.xxx.com/api</span>  <span class=c1># ✅要写在参数配置下方
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err>}</span>
</span></span></code></pre></div><h2 id=参考链接>参考链接<a hidden class=anchor aria-hidden=true href=#参考链接>#</a></h2><p><a href=https://www.ruanyifeng.com/blog/2016/04/cors.html>跨域资源共享 CORS 详解 https://www.ruanyifeng.com/blog/2016/04/cors.html</a></p><p><a href=https://www.cnblogs.com/konglxblog/p/16114550.html>Nginx 轻松搞定跨域问题！https://www.cnblogs.com/konglxblog/p/16114550.html</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://xinyan818.github.io/tags/cors/>Cors</a></li><li><a href=https://xinyan818.github.io/tags/nginx/>Nginx</a></li></ul><nav class=paginav><a class=next href=https://xinyan818.github.io/post/circle_animation/><span class=title>下一页 »</span><br><span>圆周运动动画</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://xinyan818.github.io/>胡思乱</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(e=>{mediumZoom(e,{margin:20,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.8)"})})</script><script type=module src=https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js></script><script nomodule src=https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js></script><script type=text/javascript async src=https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>